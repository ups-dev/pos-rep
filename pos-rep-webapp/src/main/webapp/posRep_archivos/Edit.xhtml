<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:u="http://ups.edu.ec/ui">

    <h:form id="PosRepEditForm">
        <p:dialog id="PosRepAddRol" widgetVar="PosRepEditDialog" modal="true"
                  resizable="false" draggable="false" fitViewport="true"
                  header="#{posRepBundle['PosRepEditarInforme']}" closeOnEscape="true">
            <u:verticalStack gapXs="3">
                <p:messages id="messages" closable="true">
                    <p:effect type="pulsate" event="load" delay="200" speed="500">
                        <f:param name="times" value="1"/>
                    </p:effect>
                </p:messages>

                <u:formLayout id="display">

                    <!-- Nombre del Reporte -->
                    <p:panel id="panelReporte" style="margin-top: 2px; margin-bottom: 2px" header="#{posRepBundle['RepReportesSistemaLabel_resReporte']}">
                        <u:formField label="#{posRepBundle['PosRepNombreAutor']}" for="posRepNombreArchivo"
                                     showCounter="true">
                            <p:inputText id="posRepNombreArchivo"
                                         value="#{posRepGestorArchivosController.newReporteSistema.resReporte}"
                                         autoResize="false" cols="80" rows="3" styleClass="text-uppercase"
                                         required="true"/>
                        </u:formField>

                        <u:formField label="#{posRepBundle['PosRepNombreAutor']}" for="posRepAutor"
                                     showCounter="true" style="margin-top: 5px">
                            <p:inputText id="posRepAutor"
                                         value="#{posRepGestorArchivosController.newReporteSistema.resAutor}"
                                         autoResize="false" cols="80" rows="3" styleClass="text-uppercase"/>
                        </u:formField>

                        <u:formField label="#{posRepBundle['PosRepObservaciones']}" for="arcDescripcion"
                                     showCounter="true">
                            <p:inputTextarea id="arcDescripcion"
                                             value="#{posRepGestorArchivosController.newReporteSistema.resObservaciones}"
                                             maxlength="250"
                                             autoResize="false" cols="80" rows="3" styleClass="text-uppercase"/>
                        </u:formField>

                        <u:formField id="opcionesFormato" for="posRepOpcionesFormato"
                                     style="margin-top: 5px; margin-bottom: 2px" label="#{posRepBundle['PosRepFormato']}">
                            <p:selectOneMenu id="posRepOpcionesFormato"
                                             required="true"
                                             value="#{posRepGestorArchivosController.newReporteSistema.resFormato}">
                                <f:selectItem itemLabel="#{posRepBundle['PosRepOpciones']}" itemValue=""/>
                                <f:selectItems value="#{posRepGestorArchivosController.formatOptions}" var="option"
                                               itemLabel="#{option}" itemValue="#{option}"/>

                                <p:ajax update="jasperUploadPdf,jasperUploadPanelPdf,jasperUploadExcel,jasperUploadPanelExcel"/>
                            </p:selectOneMenu>

                        </u:formField>
                        <!-- File Upload for .jasper files -->
                        <!--                        <u:horizontalStack>-->
                        <h:panelGroup id="jasperUploadPanelPdf">

                            <u:formField style="padding-top: 5px;"
                                         rendered="#{posRepGestorArchivosController.isRenderedForPdf()}">
                                <h:outputText
                                        value="#{posRepBundle['PosRepSubirPdf']}"/>
                            </u:formField>

                            <p:fileUpload id="jasperUploadPdf"
                                          rendered="#{posRepGestorArchivosController.isRenderedForPdf()}"
                                          style=" max-font-size: 8px; padding-top: 5px;"
                                          mode="advanced"
                                          listener="#{posRepGestorArchivosController.handleFileUpload}"
                                          multiple="false"
                                          allowTypes="/(\.|\/)(jasper)$/"
                                          dragDropSupport="true"
                                          fileLimit="1"
                                          required="true"
                                          requiredMessage="#{posRepBundle['PosRepRequerido']}"
                                          process="@this" immediate="true"
                                          label=" .jasper "/>

                        </h:panelGroup>

                        <h:panelGroup id="panelDataTablePdf">
                            <u:formField id="dataTablePdf" style="padding-top: 5px;"
                                         rendered="#{posRepGestorArchivosController.newReporteSistema.resArchivoJasperPd ne null}">
                                <p:panel>
                                    <h:dataTable value="#{posRepGestorArchivosController.newReporteSistema.resArchivo}"
                                                 var="file">
                                        <h:column>
                                            <h:outputText
                                                    value="#{posRepGestorArchivosController.newReporteSistema.resArchivo}"/>
                                        </h:column>
                                        <h:column>
                                            <p:commandButton id="deletePdf" icon="fa fa-file" value="eliminar"
                                                             actionListener="#{posRepGestorArchivosController.deleteFilePdf()}"
                                                             process="@this" resetValues="true"/>
                                        </h:column>
                                    </h:dataTable>
                                </p:panel>
                            </u:formField>
                        </h:panelGroup>

                        <h:panelGroup id="jasperUploadPanelExcel">

                            <u:formField style="padding-top: 5px;"
                                         rendered="#{posRepGestorArchivosController.isRenderedForExcel()}">
                                <h:outputText
                                        value="#{posRepBundle['PosRepSubirExcel']}"/>
                            </u:formField>


                            <p:fileUpload id="jasperUploadExcel"
                                          uploadLabel="Subir"
                                          rendered="#{posRepGestorArchivosController.isRenderedForExcel() }"
                                          style=" max-font-size: 8px; padding-top: 5px;"
                                          mode="advanced"
                                          listener="#{posRepGestorArchivosController.handleFileUpload}"
                                          multiple="false"
                                          allowTypes="/^[^.\/]*X\.jasper$/"
                                          dragDropSupport="true"
                                          fileLimit="1"
                                          required="true"
                                          requiredMessage="#{posRepBundle['PosRepRequerido']}"
                                          process="@this" immediate="true"
                                          label=" X.jasper "
                            />

                        </h:panelGroup>


                        <h:panelGroup id="panelDataTableExcel">
                            <u:formField id="dataTableExcel" style="padding-top: 5px;"
                                         rendered="#{posRepGestorArchivosController.newReporteSistema.resArchivoJasperExcel ne null}">
                                <p:panel>
                                    <h:dataTable
                                            value="#{posRepGestorArchivosController.newReporteSistema.resArchivoExcel}"
                                            var="file">
                                        <h:column>
                                            <h:outputText
                                                    value="#{posRepGestorArchivosController.newReporteSistema.resArchivoExcel}"/>
                                        </h:column>
                                        <h:column>
                                            <p:commandButton id="deleteExcel" icon="fa fa-file" value="eliminar"
                                                             actionListener="#{posRepGestorArchivosController.deleteFileExcel()}"
                                                             process="@this" resetValues="true"/>
                                        </h:column>
                                    </h:dataTable>
                                </p:panel>
                            </u:formField>
                        </h:panelGroup>

                        <!--                        </u:horizontalStack>-->

                    </p:panel>


                    <p:panel style="margin-top: 2px; margin-bottom: 2px" header="#{posRepBundle['PosRepSistemas']}">
                        <!-- Sistema -->
                        <u:formField for="posRepOpcionesSistemas">
                            <p:selectOneMenu id="posRepOpcionesSistemas"
                                             required="true"
                                             value="#{posRepGestorArchivosController.newReporteSistema.resSistema}">
                                <f:selectItem itemLabel="#{posRepBundle['PosRepOpciones']}" itemValue=""/>
                                <f:selectItems value="#{posRepGestorArchivosController.systemOptions}" var="option"
                                               itemLabel="#{option}" itemValue="#{option}"/>
                            </p:selectOneMenu>
                        </u:formField>

                    </p:panel>

                    <p:panel style="margin-top: 2px; margin-bottom: 2px" header="#{posRepBundle['PosRepModulos']}">
                        <!-- MÃ³dulo -->
                        <u:formField id="opcionesModulo" for="posRepOpcionesModulos"
                                     style="margin-top: 2px; margin-bottom: 2px">
                            <p:selectOneMenu id="posRepOpcionesModulos"
                                             required="true"
                                             value="#{posRepGestorArchivosController.newReporteSistema.resModulo}">
                                <f:selectItem itemLabel="#{posRepBundle['PosRepOpciones']}" itemValue=""/>
                                <f:selectItems value="#{posRepGestorArchivosController.moduleOptions}"
                                               var="option"
                                               itemLabel="#{option}" itemValue="#{option}"/>
                            </p:selectOneMenu>
                        </u:formField>
                    </p:panel>
                </u:formLayout>
            </u:verticalStack>

            <!-- Footer with Cancel and Save buttons -->
            <f:facet name="footer">
                <p:commandButton id="cancelButton" value="#{posRepBundle['Cancel']}" icon="fa fa-xmark"
                                 onclick="PF('PosRepEditDialog').hide()" type="button"/>
                <p:commandButton id="saveButton" value="#{posRepBundle['Accept']}" icon="fa fa-save"
                                 update="display,messages"
                                 actionListener="#{posRepGestorArchivosController.save}"
                                 oncomplete="handleSubmit(xhr,status,args,PF('PosRepEditDialog'));"/>
            </f:facet>
        </p:dialog>
    </h:form>
</ui:composition>
